from scapy.all import *
conf.verb=0
portas = [22,21,23,445,8080,80,9050]
pacotesIP = IP(dst='192.168.0.*')
pacotesTCP = TCP(dport=portas, flags="S")
pacote = pacotesIP/pacotesTCP

ans, unans = sr(pacote, inter=0.1, timeout=1)
print ("Porta\tEstado")
for pacoteRecebido in ans:
	print (pacoteRecebido[1][IP].sport,\
                "\t", pacoteRecebido[1][TCP].sprintf("%flags%"))
